<html>
<head>
    <style>
         body{
             background: linear-gradient(to right, #1D1A1C, #50093C, #4F02A1);
         }
        .video-content{
            width: 600px;
            text-align: center;
            left: auto;
            height: 400px;
        }
        #myvideo{
            background: black;
            text-align: center;
            margin-left: 333px;
        }
        #desc{
            color: white;
            margin-left: 333px;
        }
        .img-content{
            width: 100px;
           height: 100px;
            float: left;
            margin-top: 10px;
            margin-left: 10px;
        }
        .text-content{
            color: white;
            left: -23px;
            float: left;
            font-size: 30;
            margin-top: 40px;
        }
        .btn-content{
            position: absolute;
            margin-top: 116px;
        }
    </style>
</head>

<body>
<div class="video-content">
    <img class="img-content" src="../images/1111.png" alt="">
    <span class="text-content">小音符</span>
    <video  id="myvideo" width="100%" height="100%" controls="controls" >
        你的浏览器不支持HTML5播放此视频
        <span style="white-space:pre">	</span><!-- 支持播放的文件格式 -->
        <source src="" type='video/mp4' />
    </video>
</div>
<div class="btn-content">
    <span id="desc"></span>
    <input type="button" name="" value="上一个" onclick="preVideo()">
    <input type="button" name="" value="下一个" onclick="nextVideo()">
</div>

<script language="javascript" src="../js/jquery.min.js"></script>
<script language="javascript">
    var requestCount = 1;
    $(function () {
        loadData(requestCount);
    })
    $(document).ready(function(){
        video.play();
    });
    var vList = []; // 初始化播放列表
    var curr = 0;
    var video = document.getElementById("myvideo");
    video.addEventListener('ended', function(){
        play();
    });

    function firstPlay() {
        video.src = vList[curr].videoUrl;
        $("#desc").text(vList[curr].desc);
        video.load();
        video.play();
    }

    function play() {
        video.src = vList[curr].videoUrl;
        $("#desc").text(vList[curr].desc);
        video.load();
        video.play();
        curr++;
        if(curr >= vList.length){
            loadData(requestCount);
            requestCount++;
            curr = 0; //重新循环播放
        }
    }
    
    function loadData(page) {
        vList = [];
        $.ajax({
            url: "/qiantai/findVideoListdouyi",
            type: "get",
            dataType: "json",
            data: {
                 'page': page,
             },
            success: function (result) {
                var list = result.data;
                list.forEach(function (item,index) {
                    vList.push(item);
                })
                firstPlay();
                console.log(vList)
            }
        });
    }

    function preVideo() {
        if(curr > 0){
            video.src = vList[curr-1].videoUrl;
            $("#desc").text(vList[curr-1].desc);
            video.load();
            video.play();
            curr--;
        }
    }

    function nextVideo() {
        if(curr < vList.length-1){
            video.src = vList[curr+1].videoUrl;
            $("#desc").text(vList[curr+1].desc);
            video.load();
            video.play();
            curr++;
        }else {
            requestCount++;
            loadData(requestCount);
            curr = 0;
        }
    }
</script>
</body>
</html>